\section{Measurement Techniques}
Visible light has frequencies in the THz range which is well beyond the capabilites of modern electronics to directly measure so a number of clever strategies have been developed to measure the spectral quality of laser systems.
The performance of \gls*{ps} and \gls{pdh} frequency stabilisation has been characterised using a number of methods which are detailed here.
Spectral linewidth is the principle metric by which stabilisation techniques are compared and it can be considered over a range of timescales with different implications.
Short timescales measurements, less than a second, indicate the narrowness of the frequency spectrum and are useful when considering frequency dependent interactions, such as those with atoms or optical cavities.
Long timescale measurements, minutes to hours, are useful to determine the stability of the laser and its succeptability to frequency drift and the robustness of the locking scheme.

\subsection{Heterodyne Methods}

Heterodyning is a technique, invented by Canadian Reginald Feessenden in 1901, which mixes two frequencies to produce a new frequency~\cite{cooper_physics_2001}.
The technique can be used to examine the spectral properties of lasers as the newly produced frequencies can be tailored such that they are easily measurable by photodetectors and spectrum analysers.

Laser frequency spectrum measurements using heterodyne technique are simple to implement with the correct equipment.
The two laser beams are combined such that they copropagate, requiring some mirrors and a beamsplitter/combiner, and then focussed onto a high-bandwidth photodetector, where the bandwidth is dependent on the desired resolution.
The signal from the detector can then be fed into an equally high bandwidth spectrum analyser which will display the frequency spectrum of the intensity of the light on the detector.

\subsubsection{Basic Theory}
In the electrical signals context heterodyning involves the `mixing' or multiplying of two signals (e.g. two sine waves) to produce two different signals with frequencies equal to the difference and sum of the original frequencies:
\begin{equation}
\sin(\theta_1)\sin(\theta_2) = \frac{1}{2} \cos(\theta_1-\theta_2) - \frac{1}{2} \cos(\theta_1+\theta_2).
\end{equation}

In the optical context this is achieved due to the interference term accrued when squaring the electric field in order to calculate the intensity detected by the photodetector. The intensity of an electric field is given by:
\begin{equation}
I(t) = \frac{c\epsilon_0}{2}|E|^2.
\end{equation}

For two copropagating lasers with electric fields $E_{1, 2}$ and angular frequencies $\omega_{1, 2}$ we can write
\begin{equation}
E_{i}(t) = \sin(\omega_{i}t).
\end{equation}
The electric field at the detector, $E_T$, is given by the sum of $E_{1}$ and $E_{2}$, and thus the intensity is given by,
\begin{align}
I(t) &= |E_1(t) + E_2(t)|^2\nonumber\\
&= |E_1(t)|^2 + E_1(t)E_2^*(t) + |E_2(t)|^2.
\end{align}
The interference term, $E_1(t)E_2(t)$, allows for the spectral measurements with optical signals as
\begin{align}
E_1(t)E_2(t) &= \sin(\omega_1 t) \sin(\omega_2 t) \notag \\
&= \frac{1}{2} (\cos([\omega_1-\omega_2]t) - \cos([\omega_1+\omega_2]t)), \label{equation:hetero}
\end{align}
and if $\omega_{1,2}$ are appropriately selected then the first term in Equation~\ref{equation:hetero} is measurable.
The difference in frequency ideally should be fairly small, less than a few GHz, which can often be induced on lasers with the same frequency by \glspl{aom} or \glspl{eom}.

The equations presented above provide an obviously na\"ive approach as the frequency spread of the lasers is non-zero but gives a sufficient demonstration of the basis of the heterodyne method.
The spectral profile of the heterodyne signal is formed by the convolution of the spectral profiles of the component lasers, thus strategies are required in order to resolve the lineshape of a single laser.
For two near identical lasers with Gaussian lineshape the beatnote width is $2\sqrt{2\log_e2}\sim2.35$ (see Appendix~\ref{appendix:heterodyne}).

\subsubsection{Frequency Reference}
One method of resolving the lineshape of a single laser is to use a second laser known to have a frequency lineshape much narrower than the laser of interest so that the convolved lineshape is the same as the lineshape of the laser of interest.
This method has some limitations in its application as it is only useful for resolving the lineshape of lasers with relatively wide specral width.
This method is shown in Figure~\ref{figure:heterodyne_reference}.

\begin{figure}
    %\centering
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \includegraphics{part1/Figs/HeterodyneReferenceLaser.pdf}
    \end{subfigure}
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \input{part1/Figs/reference_laser_heterodyne.pgf}
    \end{subfigure}
    \caption{Heterodyne measurement with a narrow reference laser by combining the laser of interest ($\omega_1$, red) with the reference laser ($\omega_2$, blue). Shown on the right is the spectral lineshapes of the lasers and the heterodyne beatnote (green).}
    \label{figure:heterodyne_reference}
\end{figure}

The initial intention with the experiments described in the this chapter was to be able to use a \gls{pdh} locked laser as a frequency reference to characterise the performance of another laser locked with \gls{ps} using high-bandwidth feedback.
Unfortunately, initial measurements were unable to confirm that the \gls{pdh} locked laser was in fact much narrower than \gls{ps} locked one so more sophisticated methods were required.

\subsubsection{Self-heterodyne}

The self-heterodyne technique involves beating a laser with itself in order to perform a heterodyne measurement, as shown in Figure~\ref{figure:self-heterodyne}~\cite{okoshi_novel_1980}.
In order to perform this measurement it is necessary to split the laser into two beams and frequency shift on beam, usually with an \gls{aom}, such that the beatnote is not centred at \unit[0]{Hz}.
The two beams are still correlated so it is necessary to propagate one beam to reduce the coherence otherwise the lineshape of the beatnote would just appear as a delta function centred at the \gls{aom} frequency~\cite{richter_linewidth_1986}.
One beam of the beams is typically delayed by a very long optical fibre such that that arm of the heterodyne measurement has been delayed, ideally for as long as the coherence time of the laser.
Practically this would require optical fibres with lengths from 1 to \unit[100]{km} depending on the linewidth of the laser under investigation.
Unfortunately the absorption losses in fibres tends to be at least a few dB per kilometre making fibres longer than \unit[10]{km} troublesome to use however it is not necessary to fully decohere the beams with a delay time longer than the coherence time, as discussed in Reference~\cite{richter_linewidth_1986}.

\begin{figure}
    %\centering
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \includegraphics{part1/Figs/SelfHeterodyne.pdf}
    \end{subfigure}
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \input{part1/Figs/self-heterodyne.pgf}
    \end{subfigure}
    \caption{Self-heterodyne measurement. The laser is split with one beam frequency shifted by an \gls{aom} from the initial frequency ($\omega_1$, red) to an offset frequency ($\omega_1+\delta$, blue) to enable measurement by a spectrum analyser and then propagated through a long optical fiber to such that the beams are no longer correlated. Shown on the right is the spectral lineshapes of the laser and the heterodyne beatnote (green).}
    \label{figure:self_heterodyne}
    % Code for pgfs in Code/Figures/HeterodyneVersion.py
\end{figure}

Self-heterodyne was one of the first diagnostic tools used to measure the performance of \gls{ps}.
Figure~\ref{figure:self-heterodyne_example} shows a self-heterodyne beatnote from a laser locked with \gls{ps} without high-bandwidth feedback, the figure shows the beatnote at a few resolutions with the full beatnote, the central portion of the beatnote, and the delta-function component of the beatnote visible.
The central portion of the beatnote indicates that the laser has a \gls{fwhm} linewidth of \unit[33]{kHz} (comparable to the measurements made in Reference~\cite{torii_laser-phase_2012}), and the delta-function component of the beatnote manifests as a peak of order \unit[100]{Hz} width.
A laser locked with \gls{ps} and high-bandwidth feedback was expected to achieve a linewidth of order \unit[100]{Hz} andthe delta-function component of the self-heterodyne beatnote would confound these measurements thus other linewidth measurement techniques are required.

\begin{figure}
\center
\input{part1/Figs/Self-heterodyne_example.pgf}
\caption{An example of a self-heterodyne beatnote of an \gls{ecdl} locked with \gls{ps} (without fast-feedback) at various resolutions.
The grey shaded areas indicate the frequency range of the next figure as the resolution is increased (resolution bandwidth is, left-to-right, \unit[3]{kHz}, \unit[1]{kHz}, \unit[1]{Hz}).
The dotted red lines indicate Gaussian fits to the beatnote features, the middle fit has a \unit[-3]{dB} width (\gls{fwhm}) of \unit[77]{kHz} and the right fit a width of \unit[570]{Hz} which correspond to a laser linewidth of \unit[33]{kHz} and \unit[240]{Hz} respectively.
The horizontal axis indicates the frequency from the beatnote center.}
\label{figure:self-heterodyne_example}
% Code and data at 2014.01.31/Rb87 Cooling
\end{figure}

\subsubsection{Two-Laser Heterodyne}

Two almost identical lasers setups can be used in a heterodyne measurement to determine the lineshape under the assumption that the lineshape of each laser is the same.
This method is very similar to the self-heterodyne technique without the need to consider the coherence between the two beams.
As with self-heterodyne it is necessary to frequency shift one of the beams with an \gls{aom} such that the beanote is not centred at \unit[0]{Hz}.
A summary of two-laser heterodyne is shown in Figure~\ref{figure:two-laser_heterodyne}.

\begin{figure}
    %\centering
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \includegraphics{part1/Figs/HeterodyneTwoLasers.pdf}
    \end{subfigure}
    \begin{subfigure}{0.49\linewidth}
    %\centering
    \input{part1/Figs/two_laser_heterodyne.pgf}
    \end{subfigure}
    \caption{Heterodyne measurement with two `identical' lasers. One beam is frequency shifted by an \gls{aom} from the initial frequency ($\omega_1$, red) to an offset frequency ($\omega_1+\delta$, blue) to enable measurement by a spectrum analyser. Shown on the right is the spectral lineshapes of the lasers and the heterodyne beatnote (green).}
    \label{figure:two-laser_heterodyne}
\end{figure}

Two-laser heterodyne provides a useful measurement due to its simplicity and the lack of confounding effects (such as those found with self-heterodyne) and thus can relatively easily provide confidence in the results of the measurement.
The downside of this method is the obvious requirement for two very similar lasers frequency stabilised with the same methods to be used.

In order to test the efficacy of high-bandwidth \gls{ps} two similar laser setups were used; both used commercial Littrow configuration lasers\footnote{MOGLabs ECD003 and Toptica DL pro controlled with MOGLabs DLC202 and DLC252 laser controllers respectively.}, identical optic setups as shown in Figure~\ref{figure:two_laser_setup} with optical fibres that can be connected to the diagnostic measurements such as the heterodyne setup and the high-finesse cavity.

\begin{figure}
\center
\includegraphics[width=\linewidth]{part1/Figs/ps_two_laser.pdf}
\caption{Schematic of the polarisation spectroscopy apparatus used to measure the performance of the high-bandwidth feedback. The beam from the laser passes through an isolator before being split into two beams by an \gls{pbs} and coupled into optical fibres.
One fibre leads to the \gls{ps} setup shown here, the other to the measurement apparatus via an \gls{aom}.
The \gls{ps} setup consists of a polarisation stabilising Glan-Thompson prism folled by a beam expanding telescope.
The expanded beam is then divided by a \gls{pbs} into a linearly polarised probe and circularly polarised pump which counter-propagate, via a non-polarising 50:50 \gls{bs}, through the magnetically-shielded \unit[15]{cm}-long rubidium gas sample.
The polarisation rotation of the probe beam is then measured by a balanced polarimeter which consists of a $\lambdaup/2$ waveplate, \gls{pbs} and two high-bandwidth photodetectors (Thorlabs PDA10A).}
\label{figure:two_laser_setup}
\end{figure}

A \unit[1]{GHz} detector\footnote{NewFocus 1621} was connected to a spectrum analyser\footnote{\unit[9]{kHz} to \unit[7]{KHz} Rohde and Swartz FSP7} to measure the spectrum of the beatnote that was centred around \unit[80]{MHz} due to the frequency shift imposed on one beam of the heterodyne measurement by an \gls{aom}.
An example of a beatnote from two lasers locked with \gls{ps} with high-bandwidth feedback is shown in Figure~\ref{figure:two_laser_beatnote}.
These measurements indicate that \gls{ps} with high-bandwidth feedback is able to narrow the laser linewidth to \unit[0.6$\pm$0.1]{kHz} which is significant improvement, two orders of magnitude, over previously published \gls{ps} performance~\cite{torii_laser-phase_2012}.

\begin{figure}
\center
\input{part1/Figs/InsetBeatnote.pgf}
\caption{Heterodyne beatnote for two lasers locked with \gls{ps} and inset is a higher resolution measurement of the centre peak which has a -3dB width (\gls{fwhm}) of \unit[2.0$\pm$0.36]{kHz} which corresponds to a laser width of \unit[0.6$\pm$0.1]{kHz}.
Both figures are 50-shot averages captured with resolution bandwidths of \unit[30]{kHz} and \unit[100]{Hz} and total measurement times of \unit[0.5]{s} and \unit[2]{s} respectively.}
\label{figure:two_laser_beatnote}
% Code and data located at Code/PolSpec Code/Laser/Beatnote/Beatnote Inset.py
\end{figure}

\subsection{Cavity Diagnostics}

The high-finesse optical cavity used for \gls{pdh} frequency stabilisation provides a useful diagnostic tool for examining laser spectral behaviour.
There are a large number of ways that the cavity can be used to examine the specral behaviour of a laser system, two that were particularly useful are detailed in this section.

\subsubsection{Cavity Resonance Sweep}

The high-finesse optical cavity provides a useful tool for quickly checking the efficacy of high-bandwidth locking if the cavity and final laser linewidth are within a few orders of magnitude of each other.
While attempting to lock a laser the transmission of the laser through the cavity, an \gls{aom} is used to sweep the diagnostic beam across the cacity resonance, the jitter of the laser can be monitored as the bandwith of the locking scheme is increased.
An example of this process is shown in Figure~\ref{figure:cavity_scans} where the laser is locked with \gls{ps} as the bandwidth of the servo system is increased.
This method proved particularly useful when performing two-laser heterodyne measurements with \gls{ps} locked lasers as the succesfull locking of the laser could be confirmed with the cavity before attempting to measure the heterodyne beatnote.

\begin{figure}
\center
\input{part1/Figs/CavityScans.pgf}
\caption{Optical cavity transmission as a function of frequency offset from the cavity resonance for varying laser locking bandwidths. Piezo only laser feedback (left), piezo and slow curent feedback (middle), and piezo, slow current and fast current feedback. Cavity \gls{fwhm} \unit[72]{kHz}.}
\label{figure:cavity_scans}
% Code and data located at Code/PolSpec Code/Laser/Noise PSD/noiseplot.py
\end{figure}

\subsubsection{One-Sided Peak Measurements}\label{section:one_sided_peak}

If the linewidth of the laser is lower than that of the optical cavity then the cavity can be used to directly measure the linewidth of the laser.
As shown in Section~\ref{section:cavity_theory}, the transmission through the caivty, as a function of laser frequency, can be described by a Airy function,
\begin{equation}
T(f) = \frac{1}{1+F\left(\frac{\omega L}{c}\right)^2}.
\end{equation}
For a relatively narrow linewidth laser, the frequency of the laser into the cavity can be adjusted (with an \gls{aom} or frequency sidebands with an \gls{eom}) such that the transmission through the cavity is approximately 0.5, thus any deviations in frequency will manifest as a change in the transmission through the cavity.
An example of this is shown in Figure~\ref{figure:side_of_peak}.

\begin{figure}
\center
\input{part1/Figs/SideOfPeak.pgf}
\caption{Laser linewidth measured by measuring the transmission through the cavity. On the left figure the blue line shows the cavity transmission as the frequency of the beam into the cavity is scanned with an \gls{aom} and the green points show the cavity transmission when the \gls{aom} is used to centre the laser frequency part way up the transmission peak.
The known tranmission function (blue line) can be used to map the transmission distribution to a frequency distribution, shown as the green line in the right figure.
The dashed red line is a Gaussian fit to the frequency distribution with a \gls{rms} width of \unit[1.40$\pm$0.33]{kHz}.
The laser used with this measurement was locked with \gls{ps} and high-bandwidth feedback.}
\label{figure:side_of_peak}
% Code and data located at Code/PolSpec Code/Laser/Linewidth Through Cavity/linewidth.py
\end{figure}

\subsection{Frequency Noise Measurements}

Another type of measurement that can prove useful is frequency noise measurements where the frequency spetra of the laser is examined.
This measurement can be made by taking the on-resonance error signal from \gls{ps} or the cavity transmission signal part way up the Airy peak (similar to that used in Section~\ref{section:one_sided_peak}) and examing the frequency spectrum either with a spectrum analyser or a computer.
Noise measurements can be useful when attempting to identify frequency noise sources and for determining the bandwidth of frequency locking schemes.
The measurements shown in this section were generated by stitching frequency spectra measured with a high-bandwidth spectrum analyser\footnote{\unit[9]{kHz} to \unit[7]{KHz} Rohde and Swartz FSP7} and a computer-controlled low-bandwidth audio digitiser\footnote{\unit[24]{Hz} to \unit[100]{kHz} E-Mu E-DSP}.

Shown in Figure~\ref{figure:psd} are a number of frequency noise measurements captured from a laser locked with \gls{ps}.
The \gls{psd} measured was calibrated using the slope of the error signal on-resonance which itself can be calibrated by identifying features in the spectrum such as the \unit[31.5]{MHz} difference between the two rubidium-85 crossovers (see Figure~\ref{figure:satabs}).
The upper portion of the figure shows the frequency spectrum of the \gls{ps} error signal for a range of locking bandwidths from an unlocked laser to one fully locked with high-bandwidth feedback.
Comparing the unlocked spectrum to that of the other spectrums allows for an approximation of the bandwidth of that feedback mechanism by finding the intersection with the unlocked spectrum:
\begin{itemize}
    \item Piezo-only feedback has a frequency bandwidth of approximately \unit[1]{kHz}
    \item Piezo and slow-current feedback has a bandwidth of approximately \unit[50]{kHz}
    \item Piezo, slow-current and fast-current feedback has a bandwidth of approximately \unit[500]{kHz}
\end{itemize}
The noise floor of this measurement can be measured by examining the spectrum of the \gls{ps} error signal while the laser is far from the atomic resonance.
The spectrum of the off-resonance spectrum indicates that the on-resonance error signal is nosie limited.

\begin{figure}
\center
\input{part1/Figs/CombinedPSDs.pgf}
\caption{\Gls{psd} measurements of a \gls{ps} locked laser, the top figure is from the \gls{ps} error signal and the bottom figure is from the cavity transmission signal at half the peak height.
The \gls{psd} for a variety of scenarios is shown, the unlocked laser with no frequency stabilisation, piezo only feedback, piezo and slow current feedback, fully locked with piezo, slow current and fast current feedback, and the noise floor of the measurement where the laser frequency is far from the atomic and cavity resonances.
The measurements are shown with a superimposed smoothed curve with a moving average and window size of $10\log_{10}(f)$ where $f$ is the frequency.}
\label{figure:psd}
% Code and data located at Code/PolSpec Code/Laser/Noise PSD/plotting.py
\end{figure}

The high-finesse optical cavity provides another method to examing the frequency noise spectrum of the laser system as it provides a much lower noise measurement, this is shown in the lower portion of Figure~\ref{figure:psd}.
The cavity was used as a independent laser frequency descriminator by setting the laser frequency such that the trasmission through the cavity was half of the peak (similar to the method described in Section~\ref{section:one_sided_peak}) and the resulting signal was fed to the spectrum analysers and the resulting spectrum calibrated given the know cavity transmission function.
The noise floor for this measurement was determined by illuminated the photodetector directly with light of intensity equal to that used for the other measurement but without the frequency dependent influence of the cavity.
The noise floor for the cavity measurement is significantly lower than that of the error signal measurement and shows that there is significant signal available that could be used if the noise in the \gls{ps} error signal could be lowered.
Due to the narrow linewidth of the cavity transmission, \unit[71.6]{kHz}, it is not possible to measure the frequency noise of the other feedback-bandwidth configurations as the laser linewidth was greater than that of the cavity.

{\color{red} Explain discrepancy? Bode bumps.}

\subsubsection{Noise Integration}

The \gls{psd} of a laser, in \unit[Hz$^2$/Hz], can be decribed as~\cite{turner_frequency_2002},
\begin{equation}
S(f)=2\int_0^\infty \langle\Delta v(t)\Delta v(t+\tau)\rangle\exp(-i2\pi f \tau)d\tau,
\end{equation}
where $f$ is the Fourier frequency, and $\Delta v (t)$ is the instantaneous frequency of the laser.
The \gls{rms} linewidth of the laser is then
\begin{equation}\label{equation:noise_integration}
\Delta v^2_{rms} = \int_0^\infty S(f) df.
\end{equation}

Using Equation~\ref{equation:noise_integration} we can extract a laser linewidth from the \gls{psd} measurements to provide additional confirmation of the other linewidths measurements.
Integrating the \gls{psd} of the fully locked laser, measured with the optical cavity, results in a \gls{rms} linewidth of \unit[1.68$\pm$0.49]{kHz}.


\subsection{Long Term Stability}

Polarization spectroscopy is inherently a DC technique, susceptible to low frequency drift ($1/f$ noise).
Drift in the laser power output as the laser alignment drifts, variations in fiber coupling efficiency if fibers are used, variations in the atomic vapor density due to changes in temperature, thermal effects on the waveplates and changes to the electronic gains and offsets can all affect the lock point of \gls{ps} due to the resulting intensity noise combined with the difficulty in perfectly balancing the polarimeter.

The high-finesse cavity was used as a reference to quantify the long-term drift of the \gls{ps} locked laser over a period of \unit[60]{hours}, measured every \unit[10]{seconds}, Figure~\ref{figure:ps_drift}.
Drift in the optical cavity frequency was corrected by reference to the central frequency of a beatnote between a laser locked to the rubidium transition using saturated absorption spectroscopy and the \gls{ps} locked laser incident on the cavity.
The standard deviation of the \gls{ps}-locked laser frequency measurements was \unit[51]{kHz} over the \unit[60]{hour} measurement, approximately half the standard deviation of the measurements in~\cite{tiwari_laser_2006} and significantly smaller than the \unit[400]{kHz} quoted in~\cite{lee_frequency_2014}.
The frequency change between each measurement was on average \unit[5]{Hz}, with a standard deviation of \unit[210]{Hz}.

\begin{figure}
\center
\input{part1/Figs/ps_drift.pgf}
\caption{Frequency drift of a \gls{ps} locked laser over a \unit[60]{hour} period measured every \unit[10]{seconds} measured by the high-finesse optical cavity. The standard deviation of this measurement was \unit[51]{kHz}.}
\label{figure:ps_drift}
% Code and data located at 2016.02.29/plot.py
\end{figure}

The frequency stability of \gls{ps} is strongly dependent on the extent to which the apparatus is isolated from ambient temperature variations~\cite{yoshikawa_frequency_2003}.
In our system the lasers are temperature stabilized and isolated with acrylic enclosures, and the optical cavity was temperature controlled and isolated inside a vacuum chamber, but the \gls{ps} and saturated absorption spectroscopy components and optical components between lasers and optical cavity were not temperature controlled or shielded from the general laboratory environment.
The locking stability and drift are expected to improve with environmental isolation of all optical components and temperature stabilization of the atomic vapor cell.
The power into the \gls{ps} setup is particularly sensitive to polarization drift in the light exiting the optical fibers.
Although single-mode polarization maintaining fibers were used, they exhibited significant polarization drift with laboratory temperature variations, and it is expected that shielded free-space propagation or active power stabilization of the light into the PS setup would further improve the frequency stability.