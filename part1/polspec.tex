\section{Polarisation Spectroscopy}%\label{chapter:pol_spec}
\label{section:pol_spec_theory}

\Gls{pdh} is a powerful technique but is not atomically referenced and is fairly complicated to implement, particularly if it is to be used to its full potential.
\glsreset{ps}\Gls{ps} is an alternative frequency stabilisation technique that is atomically referenced and able to provide impressive linewidth reduction, which will be demonstrated here.
Discussions of the advantages and performance of \gls{ps} are given in the following sections.

Shown in Figure \ref{figure:pol_spec_schematic} is a schematic of an implementation of \gls{ps}.
In \gls{ps} a circularly polarised pump beam from a monochromatic laser, with frequency close to an atomic resonance, induces frequency-dependent circular birefringence in a magnetically-shielded atomic gas sample.
A linearly polarised beam from the same laser source is used to measure the birefringence, monitored with a balanced polarimeter consisting of a half-wave phase retarder, \gls{pbs} and two detectors.
The magnetic shielding of the atomic gas sample is required to prevent Faraday rotation caused by ambient magnetic fields affecting the probe beam polarisation.

\begin{figure}
\centering
\includegraphics[width=\linewidth]{part1/Figs/PolSpecSchematic.pdf}
\caption[Polarisation spectroscopy setup.]{A schematic of polarisation spectroscopy with a balanced polarimeter.
The power balance between the probe and the pump beam is controlled with the left-most $\lambda/2$ phase retarder and polarising beamsplitter (PBS).
The $\lambda/4$ retarder is adjusted to produce a circularly polarised pump beam.
The non-polarising beamsplitter (NPBS) is used to counter-propagate the pump beam through the atomic sample without altering the polarisation of the circular pump or linear probe.
The final $\lambda/2$ retarder, \gls{pbs} and the detectors form the balanced polarimeter that monitors the polarisation rotation of the probe.}
\label{figure:pol_spec_schematic}
\end{figure}

The circularly polarised pump beam induces circular birefringence in the atomic sample by partial optical pumping of the sample into one of the extreme hyperfine sublevels, $m_F=\pm F$, where $m_F$ labels the hyperfine sublevel and $F$ is the atomic angular momentum number.
This partial optical pumping, referred to here as the anisotropy of the medium, results in unequal absorption coefficients for each circular polarisation.
The linearly polarised probe beam can be decomposed into two equal and oppositely circularly polarised components which undergo different absorption due to the anisotropy.
When the circularly polarised components are recombined, after passing through the atomic sample, the probe beam becomes elliptically polarised and rotated from the original linear polarisation angle.

The dispersive error signal is the difference of the two orthogonal polarisation components~\cite{pearman_polarization_2002, hughes_polarization_2009}
\begin{equation}
P_{PS} = P_x-P_y = -P_0 \cos(2\phi+2\Phi)\label{P_PS}
\end{equation}
where $P_{x,y}$ are the power of the horizontal and vertical linearly polarised components of the probe after the sample, $P_0$ is the power of the probe in the absence of a pump beam, $\phi$ is the angle of polarisation of the probe in the absence of a pump beam and $\Phi$ is the additional polarisation rotation of the probe due to the birefringence induced by the pump.
The largest PS spectrum is produced when $\phi=\pi/4$ and since $\Phi$ is small Equation~\ref{P_PS} becomes
\begin{equation}
P_{PS} = 2P_0 \Phi.
\end{equation}
The polarisation rotation is given by
\begin{equation}
\Phi = \frac{\pi L \Delta n}{\lambda},
\end{equation}
where $L$ is the length of the atomic sample, $\lambda$ is the wavelength of the light, $\Delta n = n_+ - n_-$ and $n_\pm$ are the refractive indices affecting the circularly polarised components of the probe beam.

The refractive index and absorption of the medium are related through the Kramers-Kronig dispersion relation to give~\cite{demtroder_laser_2003}
\begin{equation}
\Delta n = \Delta\alpha_0 \frac{2c}{\omega_A \Gamma}\frac{\delta}{1+4\left(\frac{\delta}{\Gamma}\right)^2}.\label{result}
\end{equation}
Here $c$ is the speed of light, $\delta=\omega_L-\omega_A$ is the detuning of the laser from the resonance, $\omega_{L,\,A}$ are the angular frequency of the laser and the atomic resonance, and $\Gamma$ is the inverse lifetime of the excited state of the resonant transition.
$\Delta\alpha_0$ is the difference in absorption coefficients for the circular polarisation components at zero detuning.
$\Delta\alpha_0$ is the sum over all $m_F$ ground states of the difference between absorption coefficients for each circular polarisation, with $\delta=0$, weighted by the ground and excited state population differences, $\mathcal{P}_{F,m_F}-\mathcal{P}_{F',m_{F\pm1}}$;
\begin{eqnarray}
\Delta\alpha_0 &= \sum_{m_F=-F}^{+F} \Bigg[&\alpha_{(F,m_F\rightarrow F',m_{F+1})}(\mathcal{P}_{F,m_F}-\mathcal{P}_{F',m_{F+1}})-\nonumber\\
&&\alpha_{(F,m_F\rightarrow F',m_{F-1})}(\mathcal{P}_{F,m_F}-\mathcal{P}_{F',m_{F-1}})\Bigg].
\end{eqnarray}
The absorption coefficient for a given transition is $\alpha_{(F, m_F\rightarrow F',m_{F\pm1})}=N \sigma(\omega_L)$ where $N$ is the number density of interacting atoms, and $\sigma(\omega_L)$ is the absorption cross section for the transition.

The atomic substate populations established by interaction with the pump beam can be calculated using optical Bloch equations~\cite{hughes_polarization_2009}.
The PS signal is proportional to the refractive index difference given by Equation~\ref{result}, which describes a steep, background-free antisymmetric dispersive function.
%%%%%% I prefer the theory given in the paper. %%%%%
%Consider the electric field of the probe beam before it enters the atomic sample at an angle $\phi$ to the $x$ axis:
% \begin{equation}
% \vec{E}=E_0\big(\cos{\phi}\,\hat{x}+\sin{\phi}\,\hat{y}\big)
% \end{equation}
% which can be expressed in terms of the circularly polarised basis vectors, $(\hat{x}\pm i\hat{y})$,
% \begin{equation}
% \vec{E} = \frac{E_0}{2}e^{-i\phi}(\hat{x}+i\hat{y}) + \frac{E_0}{2}e^{+i\phi}(\hat{x}-i\hat{y})
% \end{equation}

% After propagating through an atomic sample of length $L$ with refractive indices for the circular polarisation components of $n_\pm$, and absorption coefficients of $\alpha_\pm$ the electric field becomes
% \begin{align}
% \vec{E}\  = \ &\frac{E_0}{2}e^{-i\phi}\,\exp\left[\frac{i\omega n_+ L}{c} - \frac{\alpha_+ L}{2}\right](\hat{x}+i\hat{y})\quad +\quad \frac{E_0}{2}e^{+i\phi}\,\exp\left[\frac{i\omega n_- L}{c} - \frac{\alpha_- L}{2}\right](\hat{x}-i\hat{y}) \notag\\ 
% \  = \ &\frac{E_0}{2} e^{-i\phi}\,\exp\left[\frac{i\omega L}{2c}(n_+-n_-) + \frac{i\omega L}{2c}(n_+ + n_-) - \frac{L}{4}(\alpha_+ -\alpha_-) - \frac{L}{4}(\alpha_+ + \alpha_-)\right](\hat{x}+i\hat{y})\ +\notag\\
% &\frac{E_0}{2} e^{+i\phi}\,\exp\left[-\frac{i\omega L}{2c}(n_+-n_-) + \frac{i\omega L}{2c}(n_-+n_+) + \frac{L}{4}(\alpha_+-\alpha_-) - \frac{L}{4}(\alpha_-+\alpha_+) \right](\hat{x}-i\hat{y}) \notag\\
% \  = \ &\frac{E_0}{2} \exp\left[\frac{i\omega L}{2c}(n_+ + n_-) - \frac{L}{4}(\alpha_+ + \alpha_-)\right] \left\{ e^{-i(\phi - \Omega)}\, \, (\hat{x}+i\hat{y})\ + e^{+i(\phi-\Omega)}\,(\hat{x}-i\hat{y})\right\},\label{equation:elliptically_polarised}
% \end{align}
% where
% \begin{equation}
% \Omega = \frac{\omega L}{2c}(n_+-n_-) + i\frac{L}{4}(\alpha_+ -\alpha_-).
% \end{equation}
% Equation \ref{equation:elliptically_polarised} represents elliptically polarised light with the major axis at an angle of $\theta = \phi + \Omega$ to the $x$-axis.

% The horizontal and vertical polarisation components of the beam are separated by the \gls{pbs},
% \begin{align}
% \vec{E} = &\frac{E_0}{2} \exp\left[\frac{i\omega L}{2c}(N_+ + n_-) - \frac{L}{4}(\alpha_++\alpha_-)\right]\ \left[ \hat{x} \left(e^{-i(\phi-\Omega)}+e^{-i(\phi-\Omega)}\right) + i\hat{y} \left(e^{-i(\phi-\Omega)}-e^{-i(\phi-\Omega)}\right)\right]\notag\\
%  = & E_0 \exp\left[\frac{i\omega L}{2c}(N_+ + n_-) - \frac{L}{4}(\alpha_++\alpha_-)\right] \bigg[ \hat{x} \cos(\phi-\Omega) + \hat{y} \sin(\phi-\Omega)\bigg],
% \end{align}
% and the intensity of the beams are then detected by photodetectors,
% \begin{align}
% I_x &= |E_x|^2 \notag \\
% & = \left|E_0 \exp\left[\frac{i\omega L}{2c}(N_+ + n_-) - \frac{L}{4}(\alpha_++\alpha_-)\right] \cos(\phi-\Omega) \right|^2 \notag \\
% & = E_0^2\left| \exp\left[\frac{i\omega L}{2c}(N_+ + n_-)\right]\exp\left[-\frac{L}{4}(\alpha_++\alpha_-)\right] \right|^2 \cos\bigg(\phi-\Omega\bigg) \cos\bigg(\overline{\phi-\Omega}\bigg) \notag \\
% & = E_0^2 \exp\left[-\frac{L}{2}(\alpha_++\alpha_-)\right] \cos\bigg(\phi-\frac{\omega L}{2c}(n_+-n_-) + i\frac{L}{4}(\alpha_+ -\alpha_-)\bigg) \cos\bigg(\phi-\frac{\omega L}{2c}(n_+-n_-) - i\frac{L}{4}(\alpha_+ -\alpha_-)\bigg) \notag \\
% & = \frac{E_0^2}{2} \exp\left[-\frac{L}{2}(\alpha_++\alpha_-)\right] \left[\cos\bigg(2i\frac{L}{4}(\alpha_+ -\alpha_-)\bigg) + \cos\bigg(2\phi-2\frac{\omega L}{2c}(n_+-n_-)\bigg)\right] \\
% \notag\\
% I_y &= |E_y|^2 \notag \\
% & = \left|E_0 \exp\left[\frac{i\omega L}{2c}(N_+ + n_-) - \frac{L}{4}(\alpha_++\alpha_-)\right] \sin(\phi-\Omega) \right|^2 \notag \\
% & = \frac{E_0^2}{2} \exp\left[-\frac{L}{2}(\alpha_++\alpha_-)\right] \left[\cos\bigg(2i\frac{L}{4}(\alpha_+ -\alpha_-)\bigg) - \cos\bigg(2\phi-2\frac{\omega L}{2c}(n_+-n_-)\bigg)\right]
% \end{align}
% and subtracted by electronics to generate the error signal,
% \begin{align}
% \epsilon =\ &I_y - I_x = E_y^2 - E_x^2 \notag \\
% =\ &E_0^2 \exp\left[-\frac{L}{2}(\alpha_++\alpha_-)\right] \cos\bigg(2\phi-2\frac{\omega L}{2c}(n_+-n_-)\bigg).
% \end{align}

% The spectral profile of $(\alpha_+-\alpha_-)$ is a power-broadened Lorentzian~\cite{pearman_polarization_2002},
% \begin{equation}
% \alpha_+ - \alpha_- = \frac{\Delta\alpha_0}{1+x^2},
% \end{equation}
% where $x=\frac{\omega_0-\omega}{\Gamma/2}$ is the detuning scaled by the atomic linewidth $\Gamma$, and $\Delta\alpha_0$ is the maximum difference in absorption coefficients at the atomic resonance.
% The absorption cooefficients and refractive indices are related via the Kramers-Kronig dispersion relation~\cite{demtroder_laser_2014},
% \begin{equation}
% n_+ - n_- = \frac{c}{\omega_0} \Delta\alpha_0 \frac{x}{1+x^2}.
% \end{equation}
% Typically the polarisation rotation induced by the medium is small and is maximised when $\phi=\frac{\pi}{4}$ giving the approximate error signal,
% \begin{equation}
% \epsilon \simeq - I_0 e^{-L(\alpha_++\alpha_-)/2}\left( L \Delta\alpha_0 \frac{x}{1+x^2}\right)
% \end{equation}

\Gls{ps} produces a dispersion shaped spectrum about the atomic resonance with zero background, as shown in Figure~\ref{figure:polspecspectrum}, and is ideal for laser locking due to the large capture range and steep gradient near the resonance.
Unlike \gls{pdh}, \gls{ps} acts as an absolute reference as it tied to the frequency of the atomic-ensemble reference.

\begin{figure}
\center
\input{part1/Figs/PolSpecSpectrum.pgf}
\caption[Polarisation spectroscopy absorption and error spectra.]{Measured absorption spectrum for \gls{ps} horizontal and vertical polarisations (red) and the corresponding error signal (blue). This spectrum is for the rubidium-85 D2 line with the horizontal axis zero relative to the $F=3$ to $F^\prime=4$ transition.}
\label{figure:polspecspectrum}
\end{figure}

\subsubsection{Balanced Polarimeter}

When Wieman and H\"anch~\cite{wieman_doppler-free_1976} originally proposed \gls{ps} polarisation rotation was monitored with a nearly crossed linear polariser as shown in Figure \ref{figure:wieman_doppler-free_schematic}.
The polariser was crossed such that only a small proportion of the probe beam passed through to the detector in the absence of the pump.
With the pump inducing anisotropy in the atomic sample the rotation of the probe could be detected after the polariser.

\begin{figure}
\center
\includegraphics{part1/Figs/PolSpecWieman.pdf}
\caption[Polarisation spectroscopy setup as suggested by Wieman and H\"ansch in 1976.]{A schematic of the \gls{ps} setup initially suggested by Wieman and H\"ansch~\cite{wieman_doppler-free_1976}. The polariser by the detector is a linear polariser crossed with the linear polariser before the gas cell.}
\label{figure:wieman_doppler-free_schematic}
\end{figure}

Pearson \emph{et al.} proposed the alternative method of using a balanced polarimeter, shown in Figure~\ref{figure:pol_spec_schematic}, which provides a background-free signal with peak-to-peak height more than an order of magnitude greater than with the crossed polariser method~\cite{pearman_polarization_2002,yoshikawa_frequency_2003}.

\subsubsection{Co-propagating Beams}

Wieman and H\"anch's initial proposal for \gls{ps} used a mirror next to the probe beamline to angle the pump beam such that it was \emph{almost} counter-propagating with the probe beam, as shown in Figure~\ref{figure:wieman_doppler-free_schematic}.
In saturated absorption spectroscopy imperfect alignment of the pump and probe results in geometric broadening of the spectral features and a reduction in the overlap region and thus the number of atoms involved and the strength of the signal~\cite{himsworth_rubidium_2010}.
\Gls{ps} does not rely on the Doppler-shifted velocities of the atoms involved and thus does not suffer from geometric broadening but the signal strength can be improved with fully counter-propagated beams.

Many saturated absorption spectroscopy setups use arrangements similar to the \gls{ps} setup shown in Figure~\ref{figure:wieman_doppler-free_schematic} in order to get the pump and probe beam to approximately counter-propagate however the layout shown in Figure~\ref{figure:satabs} provides a much simpler arrangement with anti-parallel beams and fewer required optics.
Similarly the \gls{ps} layout has been improved with the use of a non-polarising beam splitter to reflect the pump beam into the gas cell without interfering with the pump's circular polarisation or rotated linear polarisation of the probe.
Co-propagating the beams gives the pump and probe the maximum interaction volume and maximises the signal produced.

\subsection{Error Signal Characteristics}

There are a number of aspects of \gls{ps} that make it an attractive candidate for high-bandwidth frequency stabilisation.

\subsubsection{High Signal-to-Noise Ratio}

\Gls{ps} has a number of advantages with respect to \gls{snr} compared to other techniques.
\Gls{ps} is a velocity selective technique that produces a dispersive error signal with high frequency-discrimination slope, comparable to \gls{sa} and \gls{mts}.
The subtraction associated with the balanced polarimeter removes technical noise, particularly probe laser intensity noise, across the entire signal bandwidth.
The resultant \gls{ps} error signal therefore approaches the shot-noise limit and the \gls{snr} is very high over a large bandwidth, shown in Figure~\ref{figure:psd}.

\subsubsection{Modulation Free}

\Gls{ps} is a technique that does not require any modulation of the laser beam or electronic signals.
With modulation-based frequency stabilisation techniques such as \gls{pdh}, \gls{sa}, or \gls{mts}, the feedback bandwidth is theoretically limited to half the modulation frequency by the Nyquist theorem.
In practise the bandwidth is limited to well below the Nyquist limit due to the need to filter the signal to remove the second harmonic product and upconverted flicker noise at the first harmonic.
The filtering is made more difficult in servo applications by the need to keep latency low to preserve phase margin.
The absence of modulation also reduces the implementation complexity and cost but some care is required to minimise noise contributions at low frequencies which cause frequency drift.

\subsubsection{Selectivity}\label{section:capture_range}

\Gls{ps} optically pumps the atomic sample into the primary transition pair, for example the  5$^2$S$_{1/2}$ ($F=3$) $\rightarrow$ 5$^2$P$_{3/2}$ ($F^\prime=4$) transition of Rb85.
Subsidiary transitions, such as the ${F=3}$ ${\rightarrow}$ ${F^\prime=3}$, are strongly suppressed and the crossover resonances that dominate \gls{sa} become comparatively small and do not cross zero.
This selectivity, which also applies to \gls{mts}, has two important benefits.
First the \gls{ps} error signal is of the correct sign over the full Doppler with of the sample, free of the zero crossings at nearby resonances that are seen with other techniques such as \gls{sa}, allowing for high effective feedback bandwidth.

Second, if a laser locked to a \gls{ps} feature becomes unlocked, for example due to an external disturbance, there are no zero-crossings in the feedback error signal to trap the locking servo anywhere but at the desired primary transition.
This defines the capture range; that is, the range of frequencies about the resonance for which the error signal is of the correct sign to provide negative feedback.
The capture range can be deduced from the error signal by locating the zero-crossings to either side of the resonance as shown in Figure~\ref{figure:capture_range}.
For the spectra shown in Figure~\ref{figure:capture_range} the \gls{ps} capture range is greater than \unit[$\pm150$]{MHz}, many times larger than that the \unit[$\pm15$]{MHz} of \gls{sa}.

\begin{figure}
\center
\input{part1/Figs/capture_range.pgf}
\caption[Saturated absorption spectroscopy and polarisation spectroscopy capture ranges.]{Error signals generated by saturated absorption spectroscopy (top) and polarisation spectroscopy (bottom) for the Rb85 D2 transition.
The shaded regions indicate the capture range of the respective error signals, the \gls{sa} capture range is \unit[$\pm15$]{MHz} and the \gls{ps} range is greater than \unit[$\pm150$]{MHz}.}
\label{figure:capture_range}
% Code and data located at PolSpec Code/Spectra for Paper/GrapherCompletion.py
\end{figure}
